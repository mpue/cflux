generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum UserRole {
  ADMIN
  USER
}

enum TimeEntryStatus {
  CLOCKED_IN
  ON_PAUSE
  CLOCKED_OUT
}

enum AbsenceType {
  VACATION
  SICK_LEAVE
  PERSONAL_LEAVE
  UNPAID_LEAVE
  OTHER
}

enum RequestStatus {
  PENDING
  APPROVED
  REJECTED
}

enum ViolationType {
  REST_TIME
  MAX_WEEKLY_HOURS
  MAX_DAILY_HOURS
  MISSING_PAUSE
  OVERTIME_LIMIT
  NIGHT_WORK
  SUNDAY_WORK
}

enum ViolationSeverity {
  WARNING
  CRITICAL
}

model User {
  id            String          @id @default(uuid())
  email         String          @unique
  password      String
  firstName     String
  lastName      String
  role          UserRole        @default(USER)
  isActive      Boolean         @default(true)
  requiresPasswordChange Boolean @default(false)
  vacationDays  Float           @default(30)
  userGroupId   String?         // Deprecated: wird für Rückwärtskompatibilität beibehalten
  
  // Personalien
  dateOfBirth   DateTime?
  placeOfBirth  String?
  nationality   String?
  
  // Kontakt
  phone         String?
  mobile        String?
  street        String?
  streetNumber  String?
  zipCode       String?
  city          String?
  country       String?         @default("Schweiz")
  
  // Anstellung
  employeeNumber String?        @unique
  entryDate     DateTime?
  exitDate      DateTime?
  
  // Bankverbindung
  iban          String?
  bankName      String?
  
  // Persönliche Angaben
  civilStatus   String?         // ledig, verheiratet, geschieden, verwitwet
  religion      String?         // römisch-katholisch, evangelisch-reformiert, andere, keine
  
  // Sozialversicherung & Steuern
  ahvNumber     String?         @unique  // AHV-Nummer (Schweizer SV-Nummer)
  isCrossBorderCommuter Boolean @default(false)  // Grenzgänger
  
  // Swiss Compliance
  weeklyHours        Int      @default(45)  // 45 oder 50 Stunden/Woche
  canton             String?  @default("ZH") // ZH, BE, AG, BS, SG, etc.
  exemptFromTracking Boolean  @default(false) // Zeiterfassung nicht nötig (leitende Angestellte)
  contractHours      Float?   // Vertragliche Wochenstunden (für Überstunden-Berechnung)
  
  createdAt     DateTime        @default(now())
  updatedAt     DateTime        @updatedAt

  timeEntries   TimeEntry[]
  absenceRequests AbsenceRequest[]
  projectAssignments ProjectAssignment[]
  overtimeBalances OvertimeBalance[]
  complianceViolations ComplianceViolation[]
  reportedIncidents Incident[] @relation("IncidentsReported")
  assignedIncidents Incident[] @relation("IncidentsAssigned")
  workflowApprovals WorkflowInstanceStep[]
  userGroup     UserGroup? @relation("UserGroupDeprecated", fields: [userGroupId], references: [id], onDelete: SetNull)
  userGroupMemberships UserGroupMembership[]
  
  @@index([userGroupId])
  @@map("users")
}

model UserGroup {
  id          String   @id @default(uuid())
  name        String   @unique
  description String?
  color       String?  // Hex color for UI display
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  users       User[]   @relation("UserGroupDeprecated") // Deprecated
  userGroupMemberships UserGroupMembership[]
  moduleAccess ModuleAccess[]
  
  @@map("user_groups")
}

model UserGroupMembership {
  id          String   @id @default(uuid())
  userId      String
  userGroupId String
  createdAt   DateTime @default(now())
  
  user        User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  userGroup   UserGroup @relation(fields: [userGroupId], references: [id], onDelete: Cascade)
  
  @@unique([userId, userGroupId])
  @@index([userId])
  @@index([userGroupId])
  @@map("user_group_memberships")
}

model Module {
  id          String   @id @default(uuid())
  name        String   @unique
  key         String   @unique  // z.B. "time_tracking", "invoices", "projects"
  description String?
  icon        String?  // Icon name for UI
  route       String?  // Frontend route
  isActive    Boolean  @default(true)
  sortOrder   Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  groupAccess ModuleAccess[]
  
  @@map("modules")
}

model ModuleAccess {
  id          String   @id @default(uuid())
  moduleId    String
  userGroupId String
  canView     Boolean  @default(true)
  canCreate   Boolean  @default(false)
  canEdit     Boolean  @default(false)
  canDelete   Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  module      Module    @relation(fields: [moduleId], references: [id], onDelete: Cascade)
  userGroup   UserGroup @relation(fields: [userGroupId], references: [id], onDelete: Cascade)
  
  @@unique([moduleId, userGroupId])
  @@index([userGroupId])
  @@index([moduleId])
  @@map("module_access")
}

model Customer {
  id          String       @id @default(uuid())
  name        String
  contactPerson String?
  email       String?
  phone       String?
  address     String?
  zipCode     String?
  city        String?
  country     String?      @default("Schweiz")
  taxId       String?      // Steuernummer/UID
  notes       String?
  isActive    Boolean      @default(true)
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt

  projects    Project[]
  invoices    Invoice[]

  @@map("customers")
}

model Supplier {
  id          String       @id @default(uuid())
  name        String
  contactPerson String?
  email       String?
  phone       String?
  address     String?
  zipCode     String?
  city        String?
  country     String?      @default("Schweiz")
  taxId       String?      // Steuernummer/UID
  notes       String?
  isActive    Boolean      @default(true)
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt

  @@map("suppliers")
}

model ArticleGroup {
  id          String       @id @default(uuid())
  name        String       @unique
  description String?
  isActive    Boolean      @default(true)
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt

  articles    Article[]

  @@map("article_groups")
}

model Article {
  id              String       @id @default(uuid())
  articleNumber   String       @unique
  name            String
  description     String?
  articleGroupId  String?
  price           Float        @default(0)
  unit            String       @default("Stück") // Stück, Stunden, kg, m, l, etc.
  vatRate         Float        @default(7.7) // MwSt-Satz in %
  notes           String?
  isActive        Boolean      @default(true)
  createdAt       DateTime     @default(now())
  updatedAt       DateTime     @updatedAt

  articleGroup    ArticleGroup? @relation(fields: [articleGroupId], references: [id], onDelete: SetNull)
  invoiceItems    InvoiceItem[]

  @@map("articles")
}

model Project {
  id          String       @id @default(uuid())
  name        String
  description String?
  customerId  String?
  isActive    Boolean      @default(true)
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt

  customer    Customer?    @relation(fields: [customerId], references: [id], onDelete: SetNull)
  timeEntries TimeEntry[]
  assignments ProjectAssignment[]
  incidents   Incident[]

  @@map("projects")
}

model Location {
  id          String       @id @default(uuid())
  name        String
  address     String?
  description String?
  isActive    Boolean      @default(true)
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt

  timeEntries TimeEntry[]

  @@map("locations")
}

model ProjectAssignment {
  id        String   @id @default(uuid())
  userId    String
  projectId String
  createdAt DateTime @default(now())

  user    User    @relation(fields: [userId], references: [id], onDelete: Cascade)
  project Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@unique([userId, projectId])
  @@map("project_assignments")
}

model TimeEntry {
  id          String           @id @default(uuid())
  userId      String
  projectId   String?
  locationId  String?
  clockIn     DateTime
  clockOut    DateTime?
  status      TimeEntryStatus  @default(CLOCKED_IN)
  description String?
  pauseMinutes Int?            @default(0) // Pausenzeit in Minuten
  pauseStartedAt DateTime?     // Timestamp wenn aktuelle Pause gestartet wurde
  createdAt   DateTime         @default(now())
  updatedAt   DateTime         @updatedAt

  user     User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  project  Project?  @relation(fields: [projectId], references: [id], onDelete: SetNull)
  location Location? @relation(fields: [locationId], references: [id], onDelete: SetNull)

  @@index([userId, clockIn])
  @@map("time_entries")
}

model AbsenceRequest {
  id          String        @id @default(uuid())
  userId      String
  type        AbsenceType
  startDate   DateTime
  endDate     DateTime
  days        Float
  reason      String?
  status      RequestStatus @default(PENDING)
  reviewedBy  String?
  reviewedAt  DateTime?
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId, status])
  @@map("absence_requests")
}

model Holiday {
  id          String   @id @default(uuid())
  date        DateTime @unique
  name        String
  canton      String   // "CH" for national, "ZH" for canton-specific
  percentage  Float    @default(100) // 100% = full day off
  createdAt   DateTime @default(now())
  
  @@index([date, canton])
  @@map("holidays")
}

model OvertimeBalance {
  id              String   @id @default(uuid())
  userId          String
  year            Int
  regularOvertime Float    @default(0)  // Überstunden (über Vertrag, unter Höchstarbeitszeit)
  extraTime       Float    @default(0)  // Überzeit (über gesetzliche Höchstarbeitszeit)
  nightHours      Float    @default(0)  // Nachtarbeitsstunden
  sundayHours     Float    @default(0)  // Sonntagsarbeitsstunden
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  @@unique([userId, year])
  @@map("overtime_balances")
}

model ComplianceViolation {
  id              String             @id @default(uuid())
  userId          String
  type            ViolationType
  severity        ViolationSeverity  @default(WARNING)
  date            DateTime
  description     String
  actualValue     String?            // z.B. "12 Stunden" oder "8 Stunden Ruhezeit"
  requiredValue   String?            // z.B. "11 Stunden Ruhezeit"
  resolved        Boolean            @default(false)
  resolvedAt      DateTime?
  resolvedBy      String?
  notes           String?
  createdAt       DateTime           @default(now())
  
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  @@index([userId, date])
  @@index([resolved, severity])
  @@map("compliance_violations")
}

model ComplianceSettings {
  id                  String   @id @default(uuid())
  defaultWeeklyHours  Int      @default(45)
  defaultCanton       String   @default("ZH")
  overtimeLimit170    Boolean  @default(true)  // true=45h-Woche (170h limit), false=50h-Woche (140h)
  enableAutoWarnings  Boolean  @default(true)
  enableEmailAlerts   Boolean  @default(false)
  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt
  
  @@map("compliance_settings")
}

enum InvoiceStatus {
  DRAFT
  SENT
  PAID
  OVERDUE
  CANCELLED
}

enum ReminderLevel {
  FIRST_REMINDER    // 1. Mahnung
  SECOND_REMINDER   // 2. Mahnung
  FINAL_REMINDER    // 3. Mahnung / Letzte Mahnung
}

enum ReminderStatus {
  PENDING           // Vorbereitet, noch nicht versendet
  SENT              // Versendet
  PAID              // Bezahlt nach Mahnung
  ESCALATED         // An Inkasso übergeben
  CANCELLED         // Storniert
}

model InvoiceTemplate {
  id            String   @id @default(uuid())
  name          String   @unique
  isDefault     Boolean  @default(false)
  
  // Company Info
  companyName   String   @default("Ihre Firma")
  companyStreet String   @default("")
  companyZip    String   @default("")
  companyCity   String   @default("")
  companyCountry String  @default("Schweiz")
  companyPhone  String   @default("")
  companyEmail  String   @default("")
  companyWebsite String  @default("")
  companyTaxId  String   @default("")
  companyIban   String   @default("")
  companyBank   String   @default("")
  
  // Header/Footer
  headerText    String?  @db.Text
  footerText    String?  @db.Text
  
  // Styling
  primaryColor  String   @default("#2563eb")
  logoUrl       String?
  logoPosition  String?  // JSON: {x, y, width, height}
  logoAlignment String   @default("left") // left, center, right
  
  // Text Templates
  introText     String?  @db.Text
  paymentTermsText String? @db.Text
  
  // Settings
  showLogo      Boolean  @default(true)
  showTaxId     Boolean  @default(true)
  showPaymentInfo Boolean @default(true)
  
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  
  invoices      Invoice[]
  workflows     InvoiceTemplateWorkflow[]
  
  @@map("invoice_templates")
}

model Invoice {
  id            String        @id @default(uuid())
  invoiceNumber String        @unique
  invoiceDate   DateTime
  dueDate       DateTime
  customerId    String
  templateId    String?
  status        InvoiceStatus @default(DRAFT)
  subtotal      Float         @default(0)
  vatAmount     Float         @default(0)
  totalAmount   Float         @default(0)
  notes         String?       @db.Text
  isActive      Boolean       @default(true)
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt
  
  customer      Customer          @relation(fields: [customerId], references: [id], onDelete: Restrict)
  template      InvoiceTemplate?  @relation(fields: [templateId], references: [id], onDelete: SetNull)
  items         InvoiceItem[]
  reminders     Reminder[]
  workflowInstances WorkflowInstance[]
  
  @@index([customerId])
  @@index([templateId])
  @@index([status])
  @@index([invoiceDate])
  @@map("invoices")
}

model InvoiceItem {
  id          String   @id @default(uuid())
  invoiceId   String
  articleId   String?
  position    Int      @default(1)
  description String
  quantity    Float    @default(1)
  unitPrice   Float    @default(0)
  unit        String   @default("Stück")
  vatRate     Float    @default(7.7)
  totalPrice  Float    @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  invoice     Invoice  @relation(fields: [invoiceId], references: [id], onDelete: Cascade)
  article     Article? @relation(fields: [articleId], references: [id], onDelete: SetNull)
  
  @@index([invoiceId])
  @@map("invoice_items")
}

model Reminder {
  id              String         @id @default(uuid())
  invoiceId       String
  reminderNumber  String         @unique // z.B. "M-2024-001"
  level           ReminderLevel
  status          ReminderStatus @default(PENDING)
  reminderDate    DateTime       @default(now())
  dueDate         DateTime       // Neue Zahlungsfrist
  
  // Beträge
  originalAmount  Float          // Ursprünglicher Rechnungsbetrag
  reminderFee     Float          @default(0) // Mahngebühr
  interestAmount  Float          @default(0) // Verzugszinsen
  totalAmount     Float          // Gesamtbetrag inkl. Gebühren
  
  // Zinssatz
  interestRate    Float          @default(5.0) // Verzugszinssatz in %
  
  // Texte
  subject         String?        // Betreff der Mahnung
  message         String?        @db.Text // Mahntext
  notes           String?        @db.Text // Interne Notizen
  
  // Versand
  sentDate        DateTime?      // Wann wurde die Mahnung versendet
  sentBy          String?        // Wer hat die Mahnung versendet
  paidDate        DateTime?      // Wann wurde bezahlt
  
  // Schweizer Spezifika
  paymentSlipRef  String?        // QR-Rechnung Referenz
  
  createdAt       DateTime       @default(now())
  updatedAt       DateTime       @updatedAt
  
  invoice         Invoice        @relation(fields: [invoiceId], references: [id], onDelete: Cascade)
  
  @@index([invoiceId])
  @@index([status])
  @@index([level])
  @@index([reminderDate])
  @@map("reminders")
}

model ReminderSettings {
  id                      String   @id @default(uuid())
  
  // Mahnfristen (in Tagen nach Fälligkeit)
  firstReminderDays       Int      @default(7)   // 1. Mahnung nach 7 Tagen
  secondReminderDays      Int      @default(14)  // 2. Mahnung nach 14 Tagen
  finalReminderDays       Int      @default(21)  // 3. Mahnung nach 21 Tagen
  
  // Mahngebühren (CHF)
  firstReminderFee        Float    @default(10.00)
  secondReminderFee       Float    @default(20.00)
  finalReminderFee        Float    @default(30.00)
  
  // Verzugszins
  defaultInterestRate     Float    @default(5.0)  // 5% pro Jahr
  
  // Zahlungsfristen ab Mahndatum
  firstReminderPaymentDays  Int    @default(10)  // 10 Tage Zahlungsfrist
  secondReminderPaymentDays Int    @default(7)   // 7 Tage Zahlungsfrist
  finalReminderPaymentDays  Int    @default(5)   // 5 Tage Zahlungsfrist
  
  // Automatisierung
  autoSendReminders       Boolean  @default(false)
  autoEscalate            Boolean  @default(false)
  
  // Texte
  firstReminderTemplate   String?  @db.Text
  secondReminderTemplate  String?  @db.Text
  finalReminderTemplate   String?  @db.Text
  
  createdAt               DateTime @default(now())
  updatedAt               DateTime @updatedAt
  
  @@map("reminder_settings")
}

enum IncidentPriority {
  LOW
  MEDIUM
  HIGH
  CRITICAL
}

enum IncidentStatus {
  OPEN
  IN_PROGRESS
  RESOLVED
  CLOSED
}

model Incident {
  id              String           @id @default(uuid())
  title           String
  description     String           @db.Text
  priority        IncidentPriority @default(MEDIUM)
  status          IncidentStatus   @default(OPEN)
  
  // Beziehungen
  reportedById    String           // Wer hat den Vorfall gemeldet
  assignedToId    String?          // Wem ist der Vorfall zugewiesen
  projectId       String?          // Zugeordnetes Projekt
  
  // Kategorisierung
  category        String?          // z.B. "IT", "HR", "Facility", "Security"
  affectedSystem  String?          // Betroffenes System oder Bereich
  
  // Zeitstempel
  reportedAt      DateTime         @default(now())
  resolvedAt      DateTime?
  closedAt        DateTime?
  dueDate         DateTime?        // Deadline für Lösung
  
  // Details
  solution        String?          @db.Text
  notes           String?          @db.Text
  tags            String?          // JSON array of tags
  
  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt
  
  // Relations
  reportedBy      User             @relation("IncidentsReported", fields: [reportedById], references: [id], onDelete: Restrict)
  assignedTo      User?            @relation("IncidentsAssigned", fields: [assignedToId], references: [id], onDelete: SetNull)
  project         Project?         @relation(fields: [projectId], references: [id], onDelete: SetNull)
  comments        IncidentComment[]
  
  @@index([reportedById])
  @@index([assignedToId])
  @@index([projectId])
  @@index([status])
  @@index([priority])
  @@index([reportedAt])
  @@map("incidents")
}

model IncidentComment {
  id          String   @id @default(uuid())
  incidentId  String
  userId      String
  comment     String   @db.Text
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  incident    Incident @relation(fields: [incidentId], references: [id], onDelete: Cascade)
  
  @@index([incidentId])
  @@index([createdAt])
  @@map("incident_comments")
}

// ========== WORKFLOW SYSTEM ==========

enum WorkflowStepType {
  APPROVAL       // Genehmigung durch Benutzer/Gruppe
  NOTIFICATION   // Benachrichtigung
  CONDITION      // Bedingung prüfen
  DELAY          // Zeitverzögerung
  EMAIL          // E-Mail senden
  DATE_CONDITION // Datumsvergleich
  VALUE_CONDITION // Wertvergleich (Beträge, Zahlen)
  TEXT_CONDITION  // Textvergleich
  LOGIC_AND       // UND-Verknüpfung
  LOGIC_OR        // ODER-Verknüpfung
}

enum WorkflowStepStatus {
  PENDING
  APPROVED
  REJECTED
  SKIPPED
  COMPLETED
}

enum WorkflowInstanceStatus {
  PENDING
  IN_PROGRESS
  COMPLETED
  REJECTED
  CANCELLED
}

model Workflow {
  id              String                @id @default(uuid())
  name            String
  description     String?               @db.Text
  isActive        Boolean               @default(true)
  
  // Workflow Definition (JSON)
  definition      String                @db.Text // JSON mit Nodes und Connections
  
  createdAt       DateTime              @default(now())
  updatedAt       DateTime              @updatedAt
  
  // Beziehungen
  steps           WorkflowStep[]
  templateLinks   InvoiceTemplateWorkflow[]
  instances       WorkflowInstance[]
  
  @@map("workflows")
}

model WorkflowStep {
  id              String            @id @default(uuid())
  workflowId      String
  
  // Step Configuration
  name            String
  type            WorkflowStepType
  order           Int               // Reihenfolge im Workflow
  
  // Approval Configuration
  approverUserIds String?           @db.Text // JSON Array von User IDs
  approverGroupIds String?          @db.Text // JSON Array von UserGroup IDs
  requireAllApprovers Boolean       @default(false) // true = alle müssen genehmigen
  
  // Condition/Notification Configuration
  config          String?           @db.Text // JSON mit zusätzlicher Config
  
  createdAt       DateTime          @default(now())
  updatedAt       DateTime          @updatedAt
  
  workflow        Workflow          @relation(fields: [workflowId], references: [id], onDelete: Cascade)
  instanceSteps   WorkflowInstanceStep[]
  
  @@index([workflowId])
  @@index([order])
  @@map("workflow_steps")
}

model InvoiceTemplateWorkflow {
  id                String          @id @default(uuid())
  invoiceTemplateId String
  workflowId        String
  order             Int             // Reihenfolge der Workflow-Ausführung
  isActive          Boolean         @default(true)
  
  createdAt         DateTime        @default(now())
  updatedAt         DateTime        @updatedAt
  
  template          InvoiceTemplate @relation(fields: [invoiceTemplateId], references: [id], onDelete: Cascade)
  workflow          Workflow        @relation(fields: [workflowId], references: [id], onDelete: Cascade)
  
  @@unique([invoiceTemplateId, workflowId])
  @@index([invoiceTemplateId])
  @@index([workflowId])
  @@map("invoice_template_workflows")
}

model WorkflowInstance {
  id              String                    @id @default(uuid())
  workflowId      String
  invoiceId       String
  
  status          WorkflowInstanceStatus    @default(PENDING)
  currentStepId   String?                   // Aktueller Workflow-Schritt
  
  startedAt       DateTime                  @default(now())
  completedAt     DateTime?
  
  createdAt       DateTime                  @default(now())
  updatedAt       DateTime                  @updatedAt
  
  workflow        Workflow                  @relation(fields: [workflowId], references: [id], onDelete: Restrict)
  invoice         Invoice                   @relation(fields: [invoiceId], references: [id], onDelete: Cascade)
  steps           WorkflowInstanceStep[]
  
  @@index([workflowId])
  @@index([invoiceId])
  @@index([status])
  @@map("workflow_instances")
}

model WorkflowInstanceStep {
  id              String              @id @default(uuid())
  instanceId      String
  stepId          String
  
  status          WorkflowStepStatus  @default(PENDING)
  
  // Approval Information
  approvedById    String?
  approvedAt      DateTime?
  comment         String?             @db.Text
  
  createdAt       DateTime            @default(now())
  updatedAt       DateTime            @updatedAt
  
  instance        WorkflowInstance    @relation(fields: [instanceId], references: [id], onDelete: Cascade)
  step            WorkflowStep        @relation(fields: [stepId], references: [id], onDelete: Restrict)
  approvedBy      User?               @relation(fields: [approvedById], references: [id], onDelete: SetNull)
  
  @@index([instanceId])
  @@index([stepId])
  @@index([status])
  @@map("workflow_instance_steps")
}

model SystemSettings {
  id                    String    @id @default(uuid())
  
  // Company Information
  companyName           String?
  companyLogo           String?   @db.Text // Base64 oder URL
  companyAddress        String?   @db.Text
  companyPhone          String?
  companyEmail          String?
  companyWebsite        String?
  companyTaxId          String?   // Steuernummer/UID
  
  // System Settings
  currency              String    @default("CHF")
  dateFormat            String    @default("DD.MM.YYYY")
  timeFormat            String    @default("HH:mm")
  language              String    @default("de")
  timezone              String    @default("Europe/Zurich")
  
  // Backup Settings
  autoBackupEnabled     Boolean   @default(false)
  backupInterval        String    @default("daily") // daily, weekly, monthly
  backupTime            String    @default("02:00") // HH:mm
  backupRetention       Int       @default(30)      // Tage
  lastBackupAt          DateTime?
  
  // Email Settings (SMTP)
  smtpEnabled           Boolean   @default(false)
  smtpHost              String?
  smtpPort              Int       @default(587)
  smtpSecure            Boolean   @default(true)    // TLS/SSL
  smtpUser              String?
  smtpPassword          String?   // Sollte verschlüsselt gespeichert werden
  smtpFromEmail         String?
  smtpFromName          String?
  
  // Invoice Settings
  invoicePrefix         String    @default("RE-")
  invoiceNumberStart    Int       @default(1000)
  invoiceNumberPadding  Int       @default(4)       // Anzahl Stellen: 0001
  invoiceTermsDays      Int       @default(30)      // Zahlungsziel
  invoiceFooter         String?   @db.Text
  
  // Feature Flags
  enableWorkflows       Boolean   @default(true)
  enableIncidents       Boolean   @default(true)
  enableCompliance      Boolean   @default(true)
  enableTimeTracking    Boolean   @default(true)
  
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt
  
  @@map("system_settings")
}
